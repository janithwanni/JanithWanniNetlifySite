{
  "hash": "8e1c2a4bce223f545545047387597ced",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Riddler Classic : How long will the Bacterial Colony Last'\nauthor: Janith Wanniarachchi\ndate: '2020-06-12'\ndescription: Atttempt at solving Riddler problem with simulations\nexecute:\n  freeze: true\n---\n\n\n# Riddler Classic\n\n**Excerpt from [FiveThirtyEight](https://fivethirtyeight.com/features/how-long-will-the-bacterial-colony-last/)**\n\n**From Adam Wagner comes a curious case of colonies:**\n\nYou are studying a new strain of bacteria, Riddlerium classicum (or R. classicum, as the researchers call it). Each R. classicum bacterium will do one of two things: split into two copies of itself or die. There is an 80 percent chance of the former and a 20 percent chance of the latter.\n\nIf you start with a single R. classicum bacterium, what is the probability that it will lead to an everlasting colony (i.e., the colony will theoretically persist for an infinite amount of time)?\n\nExtra credit: Suppose that, instead of 80 percent, each bacterium divides with probability p. Now whatâ€™s the probability that a single bacterium will lead to an everlasting colony?\n\n## Question 1\n\n### Defining the problem\n\nLet's take the case of one bacteria. Looking at the states that a bacteria can achieve it is clear that we can define a Bernoulli random variable as $$Let\\ X\\ =\\ \\{The\\ event\\ that\\ a\\ bacteria\\ will\\ split\\ into\\ two\\} \\sim Bernoulli(0.8)$$ So first we sample from a Bernoulli variable. And if it comes true then we now have two bacteria. \n\nNow let's consider the case of two bacteria where we have two trials. Guess a Bernoulli variable won't cut it now (pun intended). Let's define a new random variable as $$Let\\ Y\\ =\\ \\{The\\ number\\ of\\ bacteria\\ that\\ will\\ split\\ into\\ two\\ from\\ n\\ bacteria\\}\\\\ Y\\ \\sim Binomial(n,0.8)\\\\ where\\ n\\ is\\ the\\ number\\ of\\ bacateria\\ at\\ a\\ point\\ in\\ time$$\n\n### Dummy Simulation\n\n\n::: {.cell}\n\n:::\n\n\nSo I thought of doing a simply simulation(Is this a Monte Carlo Simulation? I have no idea.) First I thought of simulating the bacteria growth for ```time_steps``` and then I repeat that again and again for ```evolutions``` times and from there I find the probability. \n\nTo find the probability I had to make an assumption, which was that the bacteria growths with upward trend will keep on going upward, which is satisfied as the probability of all bacteria dieing is quite low (i.e. for the case of let's say 1000, then $X\\ \\sim Bin(1000,0.8)$ and $Pr(X = 0) = ^{1000}C_{0}(0.8)^{0}\\times(0.2)^{1000} \\approx 0$) \n\n\n::: {.cell}\n\n```{.r .cell-code}\nevolutions <- 60\ntime_steps <- 60\nn_bactis <- 1\nfile_name_sim <- paste(here::here(),\"/blog/data/\",\"riddler_2020_06_12_sim.csv\",sep=\"\")\nif(exists(file_name_sim)){\n  sim <- read_csv(file_name_sim)\n}else{\n  sim <- map_dfr(1:evolutions,function(x){\n  n_bactis <- 1\n    lapply(1:time_steps, function(y){\n      if(n_bactis >= (5*10^8)){\n        X <- n_bactis\n        n_bactis <- 1*10^9\n      }else{\n        X <- rbinom(1,n_bactis,0.8)\n        n_bactis <<- X * 2\n      }\n      list(evol = x,step = y,not_dead = X,tot = n_bactis)\n    }) \n  })\n  write_csv(sim,file_name_sim)\n}\n\ngood_evols <- sim %>% filter(step == time_steps & tot > 0) %>% nrow()\nprob <- good_evols / evolutions\n\nsim %>% \n  ggplot(aes(x=step,y=tot,group=evol))+\n  geom_point(size=0.2) + \n  geom_line(alpha=0.4) +\n  labs(x = \"Time Step\", y = \"Total Bacteria (capped)\",\n       title=\"Bacteria Simulation\",\n       subtitle = \"what is the probability that a single bacteria will lead to an everlasting colony?\",\n       caption = \"The total is capped at 10^9 to ensure that the simulation doesnt go beyond the integer limit\") +\n  annotate(\"label\",x=(time_steps/2),y=10^9,label = paste(\"Probability of spreading is =\",prob))\n```\n\n::: {.cell-output-display}\n![](2020-06-12-riddler-classic-how-long-will-the-bacterial-colony-last_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nThe answer to the question is that the probability is approximately 0.75 through simulations\n\nNow let's try to mathematically derive it. \n\n\n\n## Question 2\n\nSo the second question seems like its just another layer of the earlier simulation to make it adaptable for more probabilities. But in reality what they require is a mathematical proof of the answer. \n\n### Second Dummy Simulation\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevolutions <- 80\ntime_steps <- 80\nn_bactis <- 1\nprobs <- seq(0,1,by=0.1)\n\nfile_name_sim_2 <- paste(here::here(),\"/blog/data/\",\"riddler_2020_06_12_sim_2.csv\",sep=\"\")\n\nif(exists(file_name_sim_2)){\n  sim_2 <- read_csv(file_name_sim_2)\n}else{\n  sim_2 <- map_dfr(probs,function(p){\n    map_dfr(1:evolutions,function(x){\n      n_bactis <- 1\n      lapply(1:time_steps, function(y){\n        if(n_bactis >= (5*10^8)){\n          X <- n_bactis\n          n_bactis <- 1*10^9\n        }else{\n          X <- rbinom(1,n_bactis,p)\n          n_bactis <<- X * 2\n        }\n        list(prob = p,evol = x,step = y,not_dead = X,tot = n_bactis)\n      }) \n    })\n  })\n  write_csv(sim_2,file_name_sim_2)\n}\nsim_2 <- sim_2 %>% mutate(prob = as.factor(prob),\n                      evol_prob = paste(evol,prob))\n\nsim_2 %>% \n  ggplot(aes(x=step,y=tot,group=evol_prob,color=prob))+\n  geom_point(size=0.2) + \n  geom_line(alpha=0.4) + \n  labs(x = \"Time Step\", y = \"Total Bacteria (capped)\", color = \"p\")\n```\n\n::: {.cell-output-display}\n![](2020-06-12-riddler-classic-how-long-will-the-bacterial-colony-last_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nThe relationship between $p$ and the probability of a single bacteria creating a colony can be captured as follows. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ngood_evols <- sim_2 %>% filter(step == time_steps & tot > 0) %>% count(prob)\n# prob <- good_evols / evolutions\nprob_relation <- good_evols %>% mutate(perc = n / evolutions,\n                      prob = round(as.numeric(levels(good_evols$prob))[good_evols$prob],2))\nprob_relation %>% \n  ggplot(aes(x = prob,y = perc)) +\n  geom_point() +\n  stat_smooth(method=\"lm\") +\n  labs(title = \"Relationship between p and probability of a bacteria making a colony\",x = \"p\", y = \"Pr(bacteria making a colony)\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](2020-06-12-riddler-classic-how-long-will-the-bacterial-colony-last_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprob_lm <- lm(prob_relation,formula = perc ~ prob)\nsummary(prob_lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = perc ~ prob, data = prob_relation)\n\nResiduals:\n        1         2         3         4         5         6 \n-0.094048  0.002738  0.112024  0.058810  0.005595 -0.085119 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -0.8220     0.1648  -4.988 0.007556 ** \nprob          1.9071     0.2143   8.901 0.000881 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.08963 on 4 degrees of freedom\nMultiple R-squared:  0.9519,\tAdjusted R-squared:  0.9399 \nF-statistic: 79.22 on 1 and 4 DF,  p-value: 0.0008805\n```\n\n\n:::\n:::\n\n\nSo the answer I got from this hack is   \nProbability\\ of\\ one\\ Bacteria\\ becoming\\ an\\ entire\\ colony =1.9071429*p-0.8220238\n\nThis is what I could mathematically derive as much as my tiny brain can allow, \n\nTo begin with when $n = 1$ all bacteria must replicate,   \nwhen $n = 2$ still all bacteria must replicate, otherwise if only one replicates then we are still at 2 bacteria.    \nwhen $n = 4$, 3 or more should replicate,   \nwhen $n = 6$, 4 or more should replicate,   \nwhen $n = 10$, $(\\frac{10}{2}) + 1$ or more should replicate,\nwhen $n = N$, $(\\frac{N}{2}) + 1$ or more should replicate\n\nTherefore the probability that with $p$ probability of replicating, a single bacteria can make an entire colony is given by\n\n$$ Pr(X_{1} = 1) + \\sum_{i=1}^N\\sum_{j=(\\frac{i}{2}) + 1}^i Pr(X_{i} = j) $$   \n\n$$ Pr(X_{1} = 1) + \\sum_{i=1}^N\\sum_{j=(\\frac{i}{2}) + 1}^i {i \\choose j}\\times p^j \\times (1-p)^{i-j}$$   \n\nFrom here on I couldn't find a simple expression for this so I let it be at this stage. ",
    "supporting": [
      "2020-06-12-riddler-classic-how-long-will-the-bacterial-colony-last_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}