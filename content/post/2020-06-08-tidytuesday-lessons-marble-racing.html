---
title: 'TidyTuesday Lessons: Marble Racing'
author: Janith Wanniarachchi
date: '2020-06-08'
slug: tidytuesday-lessons-marble-racing
categories:
  - Statistics
tags:
  - R
  - TidyTuesday
comments: no
cover: ''
imgs: []
justify: no
lastmod: '2020-06-08T08:47:59+05:30'
license: ''
readingTime: yes
single: no
Summary: "Failed attempts and learnt lessons from TidyTuesday on Marble Racing"
---



<pre class="r"><code>tuesdata &lt;- tidytuesdayR::tt_load(2020, week = 23)</code></pre>
<pre><code>## --- Compiling #TidyTuesday Information for 2020-06-02 ----</code></pre>
<pre><code>## --- There is 1 file available ---</code></pre>
<pre><code>## --- Starting Download ---</code></pre>
<pre><code>## 
##  Downloading file 1 of 1: `marbles.csv`</code></pre>
<pre><code>## --- Download complete ---</code></pre>
<pre class="r"><code>marbles &lt;- tuesdata$marbles
library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ──────────────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.2.1     ✓ purrr   0.3.4
## ✓ tibble  3.0.1     ✓ dplyr   1.0.0
## ✓ tidyr   1.0.0     ✓ stringr 1.4.0
## ✓ readr   1.3.1     ✓ forcats 0.4.0</code></pre>
<pre><code>## Warning: package &#39;tibble&#39; was built under R version 3.6.2</code></pre>
<pre><code>## Warning: package &#39;purrr&#39; was built under R version 3.6.2</code></pre>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 3.6.2</code></pre>
<pre><code>## ── Conflicts ─────────────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(ggbump)</code></pre>
<pre><code>## Warning: package &#39;ggbump&#39; was built under R version 3.6.2</code></pre>
<pre class="r"><code>library(RColorBrewer)
library(rjags)</code></pre>
<pre><code>## Loading required package: coda</code></pre>
<pre><code>## Linked to JAGS 4.3.0</code></pre>
<pre><code>## Loaded modules: basemod,bugs</code></pre>
<pre class="r"><code>library(tidystringdist)
theme_set(theme_minimal())

marbles &lt;- marbles %&gt;% select(-notes,-host,-source)

# Fix missing values ------------------------------------------------------


# Players that have played under different teams --------------------------

marbles %&gt;% 
  group_by(marble_name) %&gt;% 
  summarize(teams = n_distinct(team_name)) %&gt;% 
  filter(teams &gt; 1)</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 0 x 2
## # … with 2 variables: marble_name &lt;chr&gt;, teams &lt;int&gt;</code></pre>
<pre class="r"><code># No marbles switched teams


# Track Length affects player performance ---------------------------------

marbles %&gt;% 
  count(marble_name)</code></pre>
<pre><code>## # A tibble: 32 x 2
##    marble_name     n
##    &lt;chr&gt;       &lt;int&gt;
##  1 Anarchy         8
##  2 Billy           8
##  3 Bolt            8
##  4 Clementin       8
##  5 Clutter         8
##  6 Hazy            8
##  7 Hive            8
##  8 Limelime        8
##  9 Mallard         8
## 10 Mary            8
## # … with 22 more rows</code></pre>
<pre class="r"><code># 32 players in totla

marbles %&gt;% 
  filter(str_detect(marbles$race,&quot;Q&quot;,negate=TRUE)) %&gt;% 
  mutate(track_length_m = factor(track_length_m)) %&gt;% 
  group_by(track_length_m,marble_name) %&gt;% 
  mutate(row_id = row_number()) %&gt;% 
  ungroup()  %&gt;% 
  ggplot(aes(x=track_length_m,y=time_s))+
  geom_col(alpha=0.3) +
  geom_point(size=0.4) + geom_line(aes(group=row_id),alpha=0.8) + 
  facet_wrap(~ marble_name,nrow=8) +
  theme_bw()</code></pre>
<pre><code>## Warning: Removed 3 rows containing missing values (position_stack).</code></pre>
<pre><code>## Warning: Removed 3 rows containing missing values (geom_point).</code></pre>
<p><img src="/post/2020-06-08-tidytuesday-lessons-marble-racing_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<pre class="r"><code># track length doesnt affect performance


# Building the dream marbel racing team -----------------------------------
marbles &lt;- marbles %&gt;% 
  mutate(race_type = str_match(marbles$race,&quot;S1([A-Z])\\d&quot;)[,2],
         race_number = as.numeric(str_match(marbles$race,&quot;S1[A-Z](\\d)&quot;)[,2]))

total_points &lt;- marbles %&gt;% 
  filter(race_type == &quot;R&quot;) %&gt;% 
  group_by(marble_name) %&gt;% 
  summarize(total_points = sum(points,na.rm = T)) %&gt;% 
  ungroup() %&gt;% 
  arrange(desc(total_points)) %&gt;% 
  mutate(marble_rank = row_number())</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre class="r"><code>getPalette = colorRampPalette(brewer.pal(9, &quot;Set1&quot;))

marbles &lt;- marbles %&gt;% 
  left_join(total_points)</code></pre>
<pre><code>## Joining, by = &quot;marble_name&quot;</code></pre>
<pre class="r"><code>data &lt;- marbles %&gt;% 
  filter(race_type == &quot;R&quot;) %&gt;% 
  group_by(race_number) %&gt;% 
  arrange(time_s) %&gt;% 
  mutate(rank = row_number()) %&gt;% 
  ungroup() %&gt;% 
  select(rank,race_number,team_name,marble_name,marble_rank)

m_plot&lt;- data %&gt;% 
  ggplot(aes(x=race_number,y=rank,group=marble_name,color=team_name)) +
  geom_bump(size = 0.5, alpha = 0.3) +
  geom_point(size=0.4) + 
  geom_bump(data=data %&gt;% filter(marble_rank &lt;= 5),alpha=1,size=1.5)+
  geom_point(data=data %&gt;% filter(marble_rank &lt;= 5),size=1.9) + 
  geom_bump(data=data %&gt;% filter(marble_rank &lt;= 10 &amp; marble_rank &gt; 5),
            alpha=0.6,size=1.0) + 
  geom_point(data=data %&gt;% filter(marble_rank &lt;= 5),size=1.4) +
  scale_y_reverse() +
  scale_color_manual(values = getPalette(length(unique(marbles$team_name))))+
  theme(legend.position=&quot;bottom&quot;) +
  guides(color=guide_legend(nrow=2)) + 
  labs(x = &quot;Race Number&quot;, y= &quot;Rank in each race&quot;,color=&quot;Team Name&quot;,
       title=&quot;Marbula One Player Performance&quot;,
       subtitle = &quot;Thicker lines mean higher final rank by points&quot;)

m_plot</code></pre>
<p><img src="/post/2020-06-08-tidytuesday-lessons-marble-racing_files/figure-html/unnamed-chunk-1-2.png" width="672" /></p>
<pre class="r"><code>ggsave(plot=m_plot,&quot;tidy_tuesday_2020_06_02.png&quot;,width=297,height=210,units=&quot;mm&quot;)



# Adding aditional site statistics ----------------------------------------

site_data &lt;- tibble(
  site = unique(marbles$site),
  turns = c(13,11,13,10,23,8,15,15),
  splits = c(1,2,2,0,1,1,1,0),
  site_avg_lap_time = c(33.58,36.55,26.94,31.29,41.12,24.11,33.95,30.31)
)

site_data</code></pre>
<pre><code>## # A tibble: 8 x 4
##   site            turns splits site_avg_lap_time
##   &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt;             &lt;dbl&gt;
## 1 Savage Speedway    13      1              33.6
## 2 O&#39;raceway          11      2              36.6
## 3 Momotorway         13      2              26.9
## 4 Hivedrive          10      0              31.3
## 5 Greenstone         23      1              41.1
## 6 Short Circuit       8      1              24.1
## 7 Razzway            15      1              34.0
## 8 Midnight Bay       15      0              30.3</code></pre>
<pre class="r"><code>marbles &lt;- marbles %&gt;% left_join(site_data)</code></pre>
<pre><code>## Joining, by = &quot;site&quot;</code></pre>
<pre class="r"><code>marbles &lt;- marbles %&gt;% 
  mutate(time_per_turn = time_s / turns) %&gt;% 
  mutate(diff_avg_site_lap_time =  site_avg_lap_time - avg_time_lap)


glimpse(marbles)</code></pre>
<pre><code>## Rows: 256
## Columns: 20
## $ date                   &lt;chr&gt; &quot;15-Feb-20&quot;, &quot;15-Feb-20&quot;, &quot;15-Feb-20&quot;, &quot;15-Feb…
## $ race                   &lt;chr&gt; &quot;S1Q1&quot;, &quot;S1Q1&quot;, &quot;S1Q1&quot;, &quot;S1Q1&quot;, &quot;S1Q1&quot;, &quot;S1Q1&quot;…
## $ site                   &lt;chr&gt; &quot;Savage Speedway&quot;, &quot;Savage Speedway&quot;, &quot;Savage …
## $ marble_name            &lt;chr&gt; &quot;Clementin&quot;, &quot;Starry&quot;, &quot;Momo&quot;, &quot;Yellow&quot;, &quot;Snow…
## $ team_name              &lt;chr&gt; &quot;O&#39;rangers&quot;, &quot;Team Galactic&quot;, &quot;Team Momo&quot;, &quot;Me…
## $ time_s                 &lt;dbl&gt; 28.11, 28.37, 28.40, 28.70, 28.71, 28.72, 28.9…
## $ pole                   &lt;chr&gt; &quot;P1&quot;, &quot;P2&quot;, &quot;P3&quot;, &quot;P4&quot;, &quot;P5&quot;, &quot;P6&quot;, &quot;P7&quot;, &quot;P8&quot;…
## $ points                 &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ track_length_m         &lt;dbl&gt; 12.81, 12.81, 12.81, 12.81, 12.81, 12.81, 12.8…
## $ number_laps            &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ avg_time_lap           &lt;dbl&gt; 28.11, 28.37, 28.40, 28.70, 28.71, 28.72, 28.9…
## $ race_type              &lt;chr&gt; &quot;Q&quot;, &quot;Q&quot;, &quot;Q&quot;, &quot;Q&quot;, &quot;Q&quot;, &quot;Q&quot;, &quot;Q&quot;, &quot;Q&quot;, &quot;Q&quot;, &quot;…
## $ race_number            &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ total_points           &lt;dbl&gt; 21, 35, 16, 13, 58, 8, 54, 0, 37, 36, 13, 15, …
## $ marble_rank            &lt;int&gt; 17, 10, 22, 25, 2, 28, 4, 32, 7, 8, 24, 23, 20…
## $ turns                  &lt;dbl&gt; 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13…
## $ splits                 &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ site_avg_lap_time      &lt;dbl&gt; 33.58, 33.58, 33.58, 33.58, 33.58, 33.58, 33.5…
## $ time_per_turn          &lt;dbl&gt; 2.162308, 2.182308, 2.184615, 2.207692, 2.2084…
## $ diff_avg_site_lap_time &lt;dbl&gt; 5.47, 5.21, 5.18, 4.88, 4.87, 4.86, 4.62, 4.47…</code></pre>
<pre class="r"><code># getPalette = colorRampPalette(brewer.pal(9, &quot;Blues&quot;))
anot_data &lt;- marbles %&gt;% 
  filter(race_type == &quot;R&quot;) %&gt;% 
  filter(marble_rank &lt;= 5 &amp; race_number &gt;= 7)

m_plot_2 &lt;- marbles %&gt;% 
  filter(race_type == &quot;R&quot;) %&gt;% 
  ggplot(aes(x=race_number,y=time_per_turn,group=marble_name,color=marble_name)) +
  #geom_point() + geom_line() 
  geom_bump(size=0.1,alpha = 0.2) + 
  geom_bump(data=marbles %&gt;% 
              filter(race_type == &quot;R&quot;) %&gt;% 
              filter(marble_rank &lt;= 5),alpha = 0.8,size=1) + 
  annotate(&quot;label&quot;,
           x=(anot_data$race_number),
           y=(anot_data$time_per_turn+anot_data$marble_rank),
           label=paste(anot_data$marble_rank,anot_data$marble_name))+
  scale_y_reverse() + 
  theme(legend.position=&quot;bottom&quot;) +
  guides(color=guide_legend(nrow=4)) + 
  labs(x = &quot;Race Number&quot;,y=&quot;Time taken per turn in track&quot;,
       title=&quot;Is time taken per turn in a track an indicator of being in the top five?&quot;,subtitle=&quot;Distance between labels shows the final points gap&quot;,
       caption=&quot;The answer is no, taking more time does help in the end&quot;) 

ggsave(plot=m_plot_2,&quot;tidy_tuesday_2020_06_02_2.png&quot;,width=297,height=210,units=&quot;mm&quot;)</code></pre>
<pre><code>## Warning: Removed 3 rows containing non-finite values (stat_bump).</code></pre>
<pre class="r"><code># Can we simulate it? -----------------------------------------------------

response &lt;- &quot;time_s&quot;

mimo &lt;- marbles %&gt;% filter(marble_name == &quot;Mimo&quot;)
comb &lt;- tidy_comb_all(names(mimo %&gt;% select_if(is.numeric)))
pmap(comb, ~ cor.test(mimo[[.x]], mimo[[.y]])) %&gt;% 
map_df(broom::tidy) %&gt;% cbind(comb, .) %&gt;% filter(p.value &lt; 0.05 &amp; V1 == &quot;time_s&quot;)</code></pre>
<pre><code>## Warning in cor(x, y): the standard deviation is zero</code></pre>
<pre><code>## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero

## Warning in cor(x, y): the standard deviation is zero</code></pre>
<pre><code>##       V1                     V2   estimate statistic      p.value parameter
## 1 time_s            number_laps  0.9676596  9.396166 8.252425e-05         6
## 2 time_s          time_per_turn  0.9481626  7.308429 3.348353e-04         6
## 3 time_s diff_avg_site_lap_time -0.8363492 -3.737030 9.656233e-03         6
##     conf.low  conf.high                               method alternative
## 1  0.8266994  0.9943213 Pearson&#39;s product-moment correlation   two.sided
## 2  0.7337218  0.9908227 Pearson&#39;s product-moment correlation   two.sided
## 3 -0.9695911 -0.3206554 Pearson&#39;s product-moment correlation   two.sided</code></pre>
<pre class="r"><code>res &lt;- pmap(comb, ~ lm(mimo[[.x]] ~ mimo[[.y]]))
get_rsquared &lt;- compose(as_mapper(~ .x$r.squared), summary)
map(res, get_rsquared) %&gt;% set_names(paste(comb$V1,comb$V2,sep=&quot;~&quot;))</code></pre>
<pre><code>## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable</code></pre>
<pre><code>## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable

## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable

## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable

## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable

## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable

## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable

## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable

## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable

## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable

## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable</code></pre>
<pre><code>## $`time_s~points`
## [1] 0.0002361519
## 
## $`time_s~track_length_m`
## [1] 0.0001425393
## 
## $`time_s~number_laps`
## [1] 0.9363651
## 
## $`time_s~avg_time_lap`
## [1] 0.1280733
## 
## $`time_s~race_number`
## [1] 5.402291e-05
## 
## $`time_s~total_points`
## [1] 0
## 
## $`time_s~marble_rank`
## [1] 0
## 
## $`time_s~turns`
## [1] 6.101839e-05
## 
## $`time_s~splits`
## [1] 0.0001022428
## 
## $`time_s~site_avg_lap_time`
## [1] 0.0001692928
## 
## $`time_s~time_per_turn`
## [1] 0.8990122
## 
## $`time_s~diff_avg_site_lap_time`
## [1] 0.69948
## 
## $`points~track_length_m`
## [1] 0.1704407
## 
## $`points~number_laps`
## [1] 0.008911521
## 
## $`points~avg_time_lap`
## [1] 0.003158073
## 
## $`points~race_number`
## [1] 0.6689143
## 
## $`points~total_points`
## [1] 0
## 
## $`points~marble_rank`
## [1] 0
## 
## $`points~turns`
## [1] 0.6267444
## 
## $`points~splits`
## [1] 0.005092298
## 
## $`points~site_avg_lap_time`
## [1] 0.008859917
## 
## $`points~time_per_turn`
## [1] 0.4205592
## 
## $`points~diff_avg_site_lap_time`
## [1] 0.7346797
## 
## $`track_length_m~number_laps`
## [1] 0.02925172
## 
## $`track_length_m~avg_time_lap`
## [1] 0.6939816
## 
## $`track_length_m~race_number`
## [1] 0.03156655
## 
## $`track_length_m~total_points`
## [1] 0
## 
## $`track_length_m~marble_rank`
## [1] 0
## 
## $`track_length_m~turns`
## [1] 0.7783536
## 
## $`track_length_m~splits`
## [1] 0.09838834
## 
## $`track_length_m~site_avg_lap_time`
## [1] 0.8931152
## 
## $`track_length_m~time_per_turn`
## [1] 0.04722856
## 
## $`track_length_m~diff_avg_site_lap_time`
## [1] 0.004842096
## 
## $`number_laps~avg_time_lap`
## [1] 0.03145092
## 
## $`number_laps~race_number`
## [1] 0.007761761
## 
## $`number_laps~total_points`
## [1] 0
## 
## $`number_laps~marble_rank`
## [1] 0
## 
## $`number_laps~turns`
## [1] 0.01518692
## 
## $`number_laps~splits`
## [1] 0.004672897
## 
## $`number_laps~site_avg_lap_time`
## [1] 0.03269012
## 
## $`number_laps~time_per_turn`
## [1] 0.9655504
## 
## $`number_laps~diff_avg_site_lap_time`
## [1] 0.6379687
## 
## $`avg_time_lap~race_number`
## [1] 0.2742551
## 
## $`avg_time_lap~total_points`
## [1] 0
## 
## $`avg_time_lap~marble_rank`
## [1] 0
## 
## $`avg_time_lap~turns`
## [1] 0.3065561
## 
## $`avg_time_lap~splits`
## [1] 0.0722008
## 
## $`avg_time_lap~site_avg_lap_time`
## [1] 0.8317845
## 
## $`avg_time_lap~time_per_turn`
## [1] 0.03217523
## 
## $`avg_time_lap~diff_avg_site_lap_time`
## [1] 0.2915618
## 
## $`race_number~total_points`
## [1] 0
## 
## $`race_number~marble_rank`
## [1] 0
## 
## $`race_number~turns`
## [1] 0.09387223
## 
## $`race_number~splits`
## [1] 0.1355932
## 
## $`race_number~site_avg_lap_time`
## [1] 0.2397444
## 
## $`race_number~time_per_turn`
## [1] 0.001386557
## 
## $`race_number~diff_avg_site_lap_time`
## [1] 0.06662354
## 
## $`total_points~marble_rank`
## [1] 0
## 
## $`total_points~turns`
## [1] 0.3636364
## 
## $`total_points~splits`
## [1] 0.5
## 
## $`total_points~site_avg_lap_time`
## [1] 0.5466926
## 
## $`total_points~time_per_turn`
## [1] 0.5321176
## 
## $`total_points~diff_avg_site_lap_time`
## [1] 0.4811507
## 
## $`marble_rank~turns`
## [1] 0.3636364
## 
## $`marble_rank~splits`
## [1] 0.5
## 
## $`marble_rank~site_avg_lap_time`
## [1] 0.5466926
## 
## $`marble_rank~time_per_turn`
## [1] 0.5321176
## 
## $`marble_rank~diff_avg_site_lap_time`
## [1] 0.4811507
## 
## $`turns~splits`
## [1] 0.01923077
## 
## $`turns~site_avg_lap_time`
## [1] 0.4622741
## 
## $`turns~time_per_turn`
## [1] 0.05200947
## 
## $`turns~diff_avg_site_lap_time`
## [1] 0.003606311
## 
## $`splits~site_avg_lap_time`
## [1] 0.1605618
## 
## $`splits~time_per_turn`
## [1] 0.002247022
## 
## $`splits~diff_avg_site_lap_time`
## [1] 0.03038482
## 
## $`site_avg_lap_time~time_per_turn`
## [1] 0.03246595
## 
## $`site_avg_lap_time~diff_avg_site_lap_time`
## [1] 0.02168235
## 
## $`time_per_turn~diff_avg_site_lap_time`
## [1] 0.6437684</code></pre>
<pre class="r"><code>map(res, get_rsquared) %&gt;% 
  set_names(paste(comb$V1,comb$V2,sep=&quot;~&quot;)) %&gt;% 
  keep(~ .x &gt; 0.5)</code></pre>
<pre><code>## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable

## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable

## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable

## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable

## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable

## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable

## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable

## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable

## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable

## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable

## Warning in summary.lm(.x[[i]], ...): essentially perfect fit: summary may be
## unreliable</code></pre>
<pre><code>## $`time_s~number_laps`
## [1] 0.9363651
## 
## $`time_s~time_per_turn`
## [1] 0.8990122
## 
## $`time_s~diff_avg_site_lap_time`
## [1] 0.69948
## 
## $`points~race_number`
## [1] 0.6689143
## 
## $`points~turns`
## [1] 0.6267444
## 
## $`points~diff_avg_site_lap_time`
## [1] 0.7346797
## 
## $`track_length_m~avg_time_lap`
## [1] 0.6939816
## 
## $`track_length_m~turns`
## [1] 0.7783536
## 
## $`track_length_m~site_avg_lap_time`
## [1] 0.8931152
## 
## $`number_laps~time_per_turn`
## [1] 0.9655504
## 
## $`number_laps~diff_avg_site_lap_time`
## [1] 0.6379687
## 
## $`avg_time_lap~site_avg_lap_time`
## [1] 0.8317845
## 
## $`total_points~site_avg_lap_time`
## [1] 0.5466926
## 
## $`total_points~time_per_turn`
## [1] 0.5321176
## 
## $`marble_rank~site_avg_lap_time`
## [1] 0.5466926
## 
## $`marble_rank~time_per_turn`
## [1] 0.5321176
## 
## $`time_per_turn~diff_avg_site_lap_time`
## [1] 0.6437684</code></pre>
<pre class="r"><code># Bayesian Modelling ------------------------------------------------------


model_string = &quot;
model{
for(i in 1:length(Y)){
Y[i] ~ dnorm(mu[i],10^(-2))
mu[i] &lt;- beta0 + beta1 * x1[i] + beta2 * x2[i] + beta3 * x3[i]
}
beta0 ~ dnorm(0,1)
beta1 ~ dnorm(29.7,10^(-2))
beta2 ~ dnorm(0,10^(-2))
beta3 ~ dnorm(15.2,10^(-2))
}
&quot;
# just for mimo

Y &lt;- mimo$time_s
X1 &lt;- mimo$number_laps
X2 &lt;- mimo$diff_avg_site_lap_time
X3 &lt;- mimo$time_per_turn

n_iter &lt;- 100000
burnin &lt;- n_iter / 2
model &lt;- jags.model(file=textConnection(model_string),
                    data = list(Y = Y,x1 = X1,x2=X2,x3=X3),
                    n.chains = 10,
                    inits = list(.RNG.name = &quot;base::Wichmann-Hill&quot;,
                    .RNG.seed = 42))</code></pre>
<pre><code>## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 8
##    Unobserved stochastic nodes: 4
##    Total graph size: 73
## 
## Initializing model</code></pre>
<pre class="r"><code>samples &lt;- coda.samples(model = model,
                        variable.names = c(&quot;beta0&quot;,&quot;beta1&quot;,&quot;beta2&quot;,&quot;beta3&quot;),
                        n.iter=n_iter)
plot(samples,trace=FALSE,density=TRUE)</code></pre>
<p><img src="/post/2020-06-08-tidytuesday-lessons-marble-racing_files/figure-html/unnamed-chunk-1-3.png" width="672" /></p>
<pre class="r"><code>summary(window(samples, start = burnin))</code></pre>
<pre><code>## 
## Iterations = 50000:1e+05
## Thinning interval = 1 
## Number of chains = 10 
## Sample size per chain = 50001 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##          Mean    SD Naive SE Time-series SE
## beta0  0.3773 1.004 0.001420       0.001521
## beta1 31.7551 3.412 0.004826       0.050895
## beta2 -0.8101 1.146 0.001621       0.002856
## beta3 -0.7841 1.164 0.001646       0.017476
## 
## 2. Quantiles for each variable:
## 
##         2.5%     25%     50%      75%  97.5%
## beta0 -1.602 -0.3013  0.3774  1.05717  2.337
## beta1 24.892 29.5489 31.7257 34.03784 38.499
## beta2 -3.063 -1.5850 -0.8082 -0.03913  1.436
## beta3 -3.089 -1.5647 -0.7755 -0.03243  1.552</code></pre>
